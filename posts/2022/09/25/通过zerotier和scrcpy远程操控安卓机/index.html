<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>通过 ZeroTier 和 Scrcpy 远程操控安卓机 | 烂杯的博客</title><meta name=keywords content="scrcpy,zerotier,wireless_debugging,adb,android12"><meta name=description content="一个曲线救国的远程手机方法"><meta name=author content="cgcel"><link rel=canonical href=https://cgcel.github.io/posts/2022/09/25/%E9%80%9A%E8%BF%87zerotier%E5%92%8Cscrcpy%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7%E5%AE%89%E5%8D%93%E6%9C%BA/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://cgcel.github.io/images/avatar.jpg><link rel=icon type=image/png sizes=16x16 href=https://cgcel.github.io/images/avatar.jpg><link rel=icon type=image/png sizes=32x32 href=https://cgcel.github.io/images/avatar.jpg><link rel=apple-touch-icon href=https://cgcel.github.io/images/avatar.jpg><link rel=mask-icon href=https://cgcel.github.io/images/avatar.jpg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="通过 ZeroTier 和 Scrcpy 远程操控安卓机"><meta property="og:description" content="一个曲线救国的远程手机方法"><meta property="og:type" content="article"><meta property="og:url" content="https://cgcel.github.io/posts/2022/09/25/%E9%80%9A%E8%BF%87zerotier%E5%92%8Cscrcpy%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7%E5%AE%89%E5%8D%93%E6%9C%BA/"><meta property="og:image" content="https://cgcel.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-25T11:24:55+08:00"><meta property="article:modified_time" content="2022-09-25T11:24:55+08:00"><meta property="og:site_name" content="CGCEL BLOG"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cgcel.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="通过 ZeroTier 和 Scrcpy 远程操控安卓机"><meta name=twitter:description content="一个曲线救国的远程手机方法"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://cgcel.github.io/posts/"},{"@type":"ListItem","position":3,"name":"通过 ZeroTier 和 Scrcpy 远程操控安卓机","item":"https://cgcel.github.io/posts/2022/09/25/%E9%80%9A%E8%BF%87zerotier%E5%92%8Cscrcpy%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7%E5%AE%89%E5%8D%93%E6%9C%BA/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"通过 ZeroTier 和 Scrcpy 远程操控安卓机","name":"通过 ZeroTier 和 Scrcpy 远程操控安卓机","description":"一个曲线救国的远程手机方法","keywords":["scrcpy","zerotier","wireless_debugging","adb","android12"],"articleBody":"写在开头 最近由于有需要远程操控手机的需求, 目前我所知道的第三方服务 TeamViewer, AirDroid, ToDesk 等均可支持远程操控安卓设备, 但是也存在一些缺点, 比如墙内连接不稳定延时高, 需要注册账号, 需要付费, 需要 Root 等, 作为折腾党, 也趁着8t刚刷上 LineageOS19.1 的这段时间重新试了一下通过安装, 配置 ZeroTier 和 Scrcpy 完成对手机的操控, 其实去年就做了这样的尝试, 但是没有做记录, 这次就趁热打铁水一篇博客吧.\n软件安装 软件安装分为操控端设备 (实例为带图形桌面的电脑), 被控端设备 (安卓手机, 实例为运行 Android 12.1 的一加8T):\n操控端  ZeroTier 1.10.1 Scrcpy 1.24 adb 1.0.41   [!Notion] 其中, Windows 环境在使用 adb 时遇到了 adb 版本过低无法使用 adb pair 指令的情况. 按照官方文档操作会输出一大串 adb 使用指引, 忘记截图了, 解决方法是更新安装的 platform-tools 文件夹内的 adb 版本. 如果更新了之后还是出现这种情况, 应该在电脑环境中检查是否有其他自带了 adb 的软件也注册了环境变量, 将其从环境变量中移除即可, 如果选择不移除, 可以直接在 adb 的安装目录启动命令行, 此时将会优先使用目录下的 adb.exe.\n 被控端  ZeroTier One 1.8.9-1 (Google Play 安装)  ZeroTier 网络注册 本方案采用 ZeroTier 构建设备点对点连接, 实现内网穿透. 要使用 ZeroTier, 应首先注册账号并创建 Network.\n创建好网络后, 在 操控端 以及 被控端 开启 ZeroTier 客户端并加入网络, 然后通过 ZeroTier 官网的个人控制台允许设备接入网络.\n设备在 ZeroTier 网络中的虚拟 IP 可以在控制台查询, 或者在设备中自行查询比对. Ok, 准备就绪, 可以开始准备操控手中的安卓设备了!\n配置无线调试 (Wireless Debugging)  安卓设备从 Android 11 开始支持通过 WiFi 调试设备, 参考链接, 根据文档描述, 我们首先开启手机的 开发者选项, 然后勾选 无线调试, 勾选后进入无线调试的子菜单, 点击 使用配对码配对设备, 此时手机会弹窗提示当前设备的 WLAN配对码, IP 地址和端口, 记下这些信息.  在操控端电脑开启命令行, 输入 adb pair IP地址:端口, 此处的信息为第一步获得的信息, 回车后继续根据提醒输入六位数字配对码, 此时不出意外的话将完成配对工作. (Optional) 存在配对成功后 adb 不会自动连接设备的情况, 此时可以在命令行输入 adb connect IP地址:端口, 注意此处的 IP 与端口并非第一步的, 而是进入无线调试子菜单页面显示的 IP 地址和端口. 连接了几次发现这里的端口都是 37995, 不知道是不是固定的端口所以不打码.  连接成功后, 在命令行输入 adb devices 即可看见刚刚配对成功的手机了, 输入 scrcpy 即可远程操控手机了.   总结 接下来只需要保证操控端能一直在线就可以实现随时随地的在外操控家中的手机了. 这个方案应该不算特别折腾, 特别是对我这种经常刷机的人来说其实环境早就装的差不多了, 只需要配对设备就可以了. 但是有一个缺点是: 一旦手机断开与局域网的连接, 重连后大概率会需要重新配对, 此时就需要重新接触手机, 打开设置查看新的配对码和端口了. 所以如果不追求连接质量与性能的话最好还是在电脑装一个模拟器.\n","wordCount":"177","inLanguage":"en","datePublished":"2022-09-25T11:24:55+08:00","dateModified":"2022-09-25T11:24:55+08:00","author":{"@type":"Person","name":"cgcel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cgcel.github.io/posts/2022/09/25/%E9%80%9A%E8%BF%87zerotier%E5%92%8Cscrcpy%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7%E5%AE%89%E5%8D%93%E6%9C%BA/"},"publisher":{"@type":"Organization","name":"烂杯的博客","logo":{"@type":"ImageObject","url":"https://cgcel.github.io/images/avatar.jpg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cgcel.github.io accesskey=h title="烂杯的博客 (Alt + H)"><img src=https://cgcel.github.io/images/avatar.jpg alt=logo aria-label=logo height=35>烂杯的博客</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://cgcel.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://cgcel.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://cgcel.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cgcel.github.io>Home</a>&nbsp;»&nbsp;<a href=https://cgcel.github.io/posts/>Posts</a></div><h1 class=post-title>通过 ZeroTier 和 Scrcpy 远程操控安卓机</h1><div class=post-meta><span title="2022-09-25 11:24:55 +0800 CST">September 25, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;cgcel</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%86%99%e5%9c%a8%e5%bc%80%e5%a4%b4 aria-label=写在开头>写在开头</a></li><li><a href=#%e8%bd%af%e4%bb%b6%e5%ae%89%e8%a3%85 aria-label=软件安装>软件安装</a><ul><li><a href=#%e6%93%8d%e6%8e%a7%e7%ab%af aria-label=操控端>操控端</a></li><li><a href=#%e8%a2%ab%e6%8e%a7%e7%ab%af aria-label=被控端>被控端</a></li></ul></li><li><a href=#zerotier-%e7%bd%91%e7%bb%9c%e6%b3%a8%e5%86%8c aria-label="ZeroTier 网络注册">ZeroTier 网络注册</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e6%97%a0%e7%ba%bf%e8%b0%83%e8%af%95-wireless-debugging aria-label="配置无线调试 (Wireless Debugging)">配置无线调试 (Wireless Debugging)</a></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></div></details></div><div class=post-content><h2 id=写在开头>写在开头<a hidden class=anchor aria-hidden=true href=#写在开头>#</a></h2><p>最近由于有需要远程操控手机的需求, 目前我所知道的第三方服务 TeamViewer, AirDroid, ToDesk 等均可支持远程操控安卓设备, 但是也存在一些缺点, 比如墙内连接不稳定延时高, 需要注册账号, 需要付费, 需要 Root 等, 作为折腾党, 也趁着8t刚刷上 LineageOS19.1 的这段时间重新试了一下通过安装, 配置 <code>ZeroTier</code> 和 <code>Scrcpy</code> 完成对手机的操控, 其实去年就做了这样的尝试, 但是没有做记录, 这次就趁热打铁水一篇博客吧.</p><h2 id=软件安装>软件安装<a hidden class=anchor aria-hidden=true href=#软件安装>#</a></h2><p>软件安装分为操控端设备 (实例为带图形桌面的电脑), 被控端设备 (安卓手机, 实例为运行 Android 12.1 的一加8T):</p><h3 id=操控端>操控端<a hidden class=anchor aria-hidden=true href=#操控端>#</a></h3><ol><li><a href=https://www.zerotier.com/download/>ZeroTier 1.10.1</a></li><li><a href=https://github.com/Genymobile/scrcpy/releases>Scrcpy 1.24</a></li><li><a href=https://developer.android.com/studio/releases/platform-tools>adb 1.0.41</a></li></ol><blockquote><p>[!Notion]
其中, Windows 环境在使用 adb 时遇到了 adb 版本过低无法使用 <code>adb pair</code> 指令的情况. 按照官方文档操作会输出一大串 adb 使用指引, 忘记截图了, 解决方法是更新安装的 platform-tools 文件夹内的 adb 版本. 如果更新了之后还是出现这种情况, 应该在电脑环境中检查是否有其他自带了 adb 的软件也注册了环境变量, 将其从环境变量中移除即可, 如果选择不移除, 可以直接在 adb 的安装目录启动命令行, 此时将会优先使用目录下的 adb.exe.</p></blockquote><h3 id=被控端>被控端<a hidden class=anchor aria-hidden=true href=#被控端>#</a></h3><ol><li>ZeroTier One 1.8.9-1 (Google Play 安装)</li></ol><h2 id=zerotier-网络注册>ZeroTier 网络注册<a hidden class=anchor aria-hidden=true href=#zerotier-网络注册>#</a></h2><p>本方案采用 ZeroTier 构建设备点对点连接, 实现内网穿透. 要使用 ZeroTier, 应首先<a href=https://my.zerotier.com/network>注册账号并创建 Network</a>.</p><p>创建好网络后, 在 <code>操控端</code> 以及 <code>被控端</code> 开启 ZeroTier 客户端并加入网络, 然后通过 ZeroTier 官网的个人控制台允许设备接入网络.</p><p><img loading=lazy src=Snipaste_2022-09-25_16-09-20.png alt></p><p>设备在 ZeroTier 网络中的虚拟 IP 可以在控制台查询, 或者在设备中自行查询比对. Ok, 准备就绪, 可以开始准备操控手中的安卓设备了!</p><h2 id=配置无线调试-wireless-debugging>配置无线调试 (Wireless Debugging)<a hidden class=anchor aria-hidden=true href=#配置无线调试-wireless-debugging>#</a></h2><ol><li>安卓设备从 Android 11 开始支持通过 WiFi 调试设备, <a href=https://developer.android.com/studio/command-line/adb#connect-to-a-device-over-wi-fi-android-11+>参考链接</a>, 根据文档描述, 我们首先开启手机的 <code>开发者选项</code>, 然后勾选 <code>无线调试</code>, 勾选后进入无线调试的子菜单, 点击 <code>使用配对码配对设备</code>, 此时手机会弹窗提示当前设备的 <code>WLAN配对码</code>, <code>IP 地址和端口</code>, 记下这些信息.
<img loading=lazy src=Snipaste_2022-09-25_16-24-51.png alt></li><li>在操控端电脑开启命令行, 输入 <code>adb pair IP地址:端口</code>, 此处的信息为第一步获得的信息, 回车后继续根据提醒输入六位数字配对码, 此时不出意外的话将完成配对工作.</li><li>(Optional) 存在配对成功后 adb 不会自动连接设备的情况, 此时可以在命令行输入 <code>adb connect IP地址:端口</code>, 注意此处的 IP 与端口并非第一步的, 而是进入无线调试子菜单页面显示的 IP 地址和端口. 连接了几次发现这里的端口都是 37995, 不知道是不是固定的端口所以不打码.
<img loading=lazy src=Snipaste_2022-09-25_16-26-53.png alt>
<img loading=lazy src=Snipaste_2022-09-25_16-34-01.png alt></li><li>连接成功后, 在命令行输入 <code>adb devices</code> 即可看见刚刚配对成功的手机了, 输入 <code>scrcpy</code> 即可远程操控手机了.
<img loading=lazy src=Snipaste_2022-09-25_16-34-53.png alt></li></ol><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>接下来只需要保证操控端能一直在线就可以实现随时随地的在外操控家中的手机了. 这个方案应该不算特别折腾, 特别是对我这种经常刷机的人来说其实环境早就装的差不多了, 只需要配对设备就可以了.
但是有一个缺点是: 一旦手机断开与局域网的连接, 重连后大概率会需要重新配对, 此时就需要重新接触手机, 打开设置查看新的配对码和端口了.
所以如果不追求连接质量与性能的话最好还是在电脑装一个模拟器.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://cgcel.github.io/tags/scrcpy/>scrcpy</a></li><li><a href=https://cgcel.github.io/tags/zerotier/>zerotier</a></li><li><a href=https://cgcel.github.io/tags/wireless_debugging/>wireless_debugging</a></li><li><a href=https://cgcel.github.io/tags/adb/>adb</a></li><li><a href=https://cgcel.github.io/tags/android12/>android12</a></li></ul><nav class=paginav><a class=prev href=https://cgcel.github.io/posts/2022/09/28/android12%E7%9A%84termux%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BD%BF%E7%94%A8frpc%E8%AE%B0%E5%BD%95/><span class=title>« Prev</span><br><span>Termux 安装并使用 Frpc</span></a>
<a class=next href=https://cgcel.github.io/posts/2022/06/07/pi4tntcase--%E6%88%91%E7%9A%84%E6%A0%91%E8%8E%93%E6%B4%BE%E6%9C%BA%E7%AE%B1/><span class=title>Next »</span><br><span>Pi4TNTCase -- 我的树莓派机箱</span></a></nav></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-cgcel-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://cgcel.github.io>烂杯的博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>